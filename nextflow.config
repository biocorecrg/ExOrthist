env {
  PYTHONNOUSERSITE = 1
  R_PROFILE_USER = "/.Rprofile"
  R_ENVIRON_USER = "/.Renviron"
}

manifest {
    mainScript = 'main.nf'
}

includeConfig "$baseDir/params.config"


process {
    queue = 'long-sl7,short-sl7'
    cache = 'lenient'
    memory='4.5G'
    cpus='1'
    time='6h'
    scratch = false

    withLabel: big_cpus {
        cpus = 3
        memory = '5G'
    }

    withLabel: incr_time_cpus {
       errorStrategy = 'retry'
       memory = '5G'
       cpus = 3
       time = {6.h * task.attempt * task.attempt}
       maxRetries = 1
    }
    withLabel: big_mem {
        cpus = 1
        memory = '5G'
    }

}

process.container = 'biocorecrg/exon_intron_pipe:0.2'
singularity.enabled = true
singularity.cacheDir = "$baseDir/singularity"

// Modify accordig to cloud parameters
profiles {
    awsbatch {
      process.executor = 'awsbatch'
      process.queue = 'spot'
      workDir = 's3://data-nf/work
      aws.region = 'eu-central-1'
      aws.batch.cliPath = '/home/ec2-user/miniconda/bin/aws'
    }
}
